<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>LTM Pool Tournament 2026</title>

<style>
body {
    margin:0;
    font-family:'Segoe UI', sans-serif;
    background: radial-gradient(circle at center,#0f5132 0%,#063d23 60%,#021d10 100%);
    color:white;
}

.overlay {
    min-height:100vh;
    max-width:1200px;
    margin:0 auto;
    padding:40px 20px;
}

h1 {
    text-align:center;
    color:#00ff99;
}

h2 {
    margin-top:40px;
}

table {
    width:100%;
    border-collapse:collapse;
    margin-bottom:30px;
    background:#0b3d26;
}

th {
    background:#006633;
    padding:10px;
}

td {
    padding:8px;
    text-align:center;
}

tbody tr:nth-child(even){
    background:#0f5132;
}

.points{
    color:#00ff99;
    font-weight:bold;
}

input{
    width:60px;
}

button{
    padding:8px 14px;
    background:#00ff99;
    border:none;
    border-radius:6px;
    cursor:pointer;
}

#logoutBtn{
    background:#ff4d4d;
    display:none;
}

.fixtures{
    max-height:250px;
    overflow-y:auto;
    background:#082c1a;
    padding:10px;
    border-radius:8px;
    margin-bottom:40px;
}

.fixtures select{
    background:#0f5132;
    color:white;
    padding:5px;
}
</style>
</head>

<body>
<div class="overlay">

<h1>ðŸŽ± LTM POOL TOURNAMENT 2026 ðŸŽ± <span id="adminBadge"></span></h1>

<div style="text-align:center;margin-bottom:20px;">
<button id="loginBtn">Admin Login</button>
<button id="logoutBtn">Logout</button>
</div>

<div id="groups"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyD-3BzT-TYnkegIJOKmAd38yxrajr8jct8",
  authDomain: "ltm-pool-tournament.firebaseapp.com",
  databaseURL: "https://ltm-pool-tournament-default-rtdb.firebaseio.com",
  projectId: "ltm-pool-tournament",
  storageBucket: "ltm-pool-tournament.firebasestorage.app",
  messagingSenderId: "1086941609764",
  appId: "1:1086941609764:web:051594093405f3ee83fdb1",
  measurementId: "G-PT3NL3RSG2"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const adminBadge = document.getElementById("adminBadge");

let isAdmin=false;
const provider = new GoogleAuthProvider();

loginBtn.onclick=()=>signInWithPopup(auth,provider);
logoutBtn.onclick=()=>signOut(auth);

onAuthStateChanged(auth,user=>{
if(user){
isAdmin=true;
adminBadge.innerText="(ADMIN)";
loginBtn.style.display="none";
logoutBtn.style.display="inline-block";
}else{
isAdmin=false;
adminBadge.innerText="";
loginBtn.style.display="inline-block";
logoutBtn.style.display="none";
}
});

const groups={
"Group A":["Pratyush","Vamshi Krishna","Bhalchandra","Bhavik","Protim"],
"Group B":["Chirag","Karan","Tameem","Arif","Syam"],
"Group C":["Ganesh","Dinesh","Yash","Rachit","Ankit"],
"Group D":["Somyadeep","Shrey","Gaurav","Abdul","Vikas"]
};

const fixtures={
"Group A":[["Pratyush","Vamshi Krishna"],["Pratyush","Bhalchandra"],["Pratyush","Bhavik"],["Pratyush","Protim"],["Vamshi Krishna","Bhalchandra"],["Vamshi Krishna","Bhavik"],["Vamshi Krishna","Protim"],["Bhalchandra","Bhavik"],["Bhalchandra","Protim"],["Bhavik","Protim"]],
"Group B":[["Chirag","Karan"],["Chirag","Tameem"],["Chirag","Arif"],["Chirag","Syam"],["Karan","Tameem"],["Karan","Arif"],["Karan","Syam"],["Tameem","Arif"],["Tameem","Syam"],["Arif","Syam"]],
"Group C":[["Ganesh","Dinesh"],["Ganesh","Yash"],["Ganesh","Rachit"],["Ganesh","Ankit"],["Dinesh","Yash"],["Dinesh","Rachit"],["Dinesh","Ankit"],["Yash","Rachit"],["Yash","Ankit"],["Rachit","Ankit"]],
"Group D":[["Somyadeep","Shrey"],["Somyadeep","Gaurav"],["Somyadeep","Abdul"],["Somyadeep","Vikas"],["Shrey","Gaurav"],["Shrey","Abdul"],["Shrey","Vikas"],["Gaurav","Abdul"],["Gaurav","Vikas"],["Abdul","Vikas"]]
};

const container=document.getElementById("groups");

for(let group in groups){

let html=`<h2>${group}</h2>
<table>
<thead><tr><th>Player</th><th>P</th><th>W</th><th>L</th><th>Points</th></tr></thead>
<tbody>`;

groups[group].forEach(player=>{
html+=`<tr data-group="${group}" data-player="${player}">
<td>${player}</td>
<td class="played">0</td>
<td class="wins">0</td>
<td class="loss">0</td>
<td class="points">0</td>
</tr>`;
});

html+=`</tbody></table>
<div class="fixtures">
<table>
<tr><th>Match</th><th>Winner</th></tr>`;

fixtures[group].forEach(match=>{
html+=`<tr>
<td>${match[0]} vs ${match[1]}</td>
<td>
<select data-group="${group}" data-p1="${match[0]}" data-p2="${match[1]}">
<option value="">Select</option>
<option value="${match[0]}">${match[0]}</option>
<option value="${match[1]}">${match[1]}</option>
</select>
</td>
</tr>`;
});

html+=`</table></div>`;
container.innerHTML+=html;
}

function updatePlayer(group,player,winInc,lossInc){
let refPath=ref(db,group+"/"+player);
onValue(refPath,snapshot=>{
let data=snapshot.val()||{wins:0,loss:0};
set(refPath,{
wins:(data.wins||0)+winInc,
loss:(data.loss||0)+lossInc
});
},{onlyOnce:true});
}

document.addEventListener("change",e=>{
if(!isAdmin) return;
if(e.target.tagName==="SELECT"){
let group=e.target.dataset.group;
let p1=e.target.dataset.p1;
let p2=e.target.dataset.p2;
let winner=e.target.value;
if(!winner) return;
let loser=winner===p1?p2:p1;
updatePlayer(group,winner,1,0);
updatePlayer(group,loser,0,1);
}
});

for(let group in groups){
for(let player of groups[group]){
onValue(ref(db,group+"/"+player),snapshot=>{
let data=snapshot.val()||{wins:0,loss:0};
let row=document.querySelector(`tr[data-group="${group}"][data-player="${player}"]`);
row.querySelector(".wins").innerText=data.wins||0;
row.querySelector(".loss").innerText=data.loss||0;
row.querySelector(".played").innerText=(data.wins||0)+(data.loss||0);
row.querySelector(".points").innerText=(data.wins||0)*2;
});
}
}

</script>
</body>
</html>
