<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>LTM Pool Tournament</title>

<style>
body { font-family: Arial; background:#f4f6f9; padding:20px; }
h2 { margin-top:40px; }
table { border-collapse: collapse; width:100%; margin-bottom:30px; background:white; }
th, td { border:1px solid #ccc; padding:8px; text-align:center; }
th { background:#2c3e50; color:white; }
input { width:50px; text-align:center; }
.qualified { background:#d4edda; font-weight:bold; }
</style>
</head>
<body>

<h1>üèÜ LTM Pool Tournament 2026</h1>
<div id="groups"></div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyD-3BzT-YnkegIJOKmAd38yxrajr8jct8",
  authDomain: "ltm-pool-tournament.firebaseapp.com",
  databaseURL: "https://ltm-pool-tournament-default-rtdb.firebaseio.com",
  projectId: "ltm-pool-tournament",
  storageBucket: "ltm-pool-tournament.firebasestorage.app",
  messagingSenderId: "1086941609764",
  appId: "1:1086941609764:web:051594093405f3ee83fdb1"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const groups = {
"Group A": ["Pratyush","Vamshi Krishna","Bhalchandra","Bhavik","Protim"],
"Group B": ["Chirag","Karan","Tameem","Arif","Syam"],
"Group C": ["Ganesh","Dinesh","Yash","Rachit","Ankit"],
"Group D": ["Somyadeep","Shrey","Gaurav","Abdul","Vikas"]
};

const container = document.getElementById("groups");

for (let groupName in groups) {

let html = `<h2>${groupName}</h2>
<table>
<thead>
<tr>
<th>Player</th>
<th>P</th>
<th>W</th>
<th>L</th>
<th>Points</th>
</tr>
</thead>
<tbody>`;

groups[groupName].forEach(player => {
html += `
<tr data-player="${player}" data-group="${groupName}">
<td>${player}</td>
<td class="played">0</td>
<td><input type="number" min="0" max="4" value="0" class="wins"></td>
<td><input type="number" min="0" max="4" value="0" class="loss"></td>
<td class="points">0</td>
</tr>`;
});

html += `</tbody></table>`;
container.innerHTML += html;
}

function updateTable(table) {

let rows = Array.from(table.querySelectorAll("tbody tr"));

rows.forEach(row => {
let w = parseInt(row.querySelector(".wins").value) || 0;
let l = parseInt(row.querySelector(".loss").value) || 0;

row.querySelector(".played").innerText = w + l;
row.querySelector(".points").innerText = w * 2;
row.classList.remove("qualified");
});

rows.sort((a,b) =>
parseInt(b.querySelector(".points").innerText) -
parseInt(a.querySelector(".points").innerText)
);

rows.forEach(row => table.querySelector("tbody").appendChild(row));
rows.slice(0,2).forEach(row => row.classList.add("qualified"));
}

document.addEventListener("input", function(e) {
if (e.target.classList.contains("wins") || e.target.classList.contains("loss")) {

let row = e.target.closest("tr");
let group = row.dataset.group;
let player = row.dataset.player;

let wins = parseInt(row.querySelector(".wins").value) || 0;
let loss = parseInt(row.querySelector(".loss").value) || 0;

set(ref(db, group + "/" + player), {
wins: wins,
loss: loss
});

updateTable(e.target.closest("table"));
}
});

for (let group in groups) {
for (let player of groups[group]) {

onValue(ref(db, group + "/" + player), snapshot => {

if (snapshot.exists()) {

let data = snapshot.val();

let row = document.querySelector(
`tr[data-group="${group}"][data-player="${player}"]`
);

row.querySelector(".wins").value = data.wins || 0;
row.querySelector(".loss").value = data.loss || 0;

updateTable(row.closest("table"));
}
});
}
}

</script>

</body>
</html>
