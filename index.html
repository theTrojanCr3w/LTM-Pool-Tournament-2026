<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>LTM Pool Tournament 2026</title>

<style>
body {
    margin:0;
    font-family:'Segoe UI',sans-serif;
    background: radial-gradient(circle at center, #0f5132 0%, #063d23 60%, #021d10 100%);
    color:white;
}

.overlay{
    min-height:100vh;
    max-width:1200px;
    margin:0 auto;
    padding:40px 20px;
}

h1{
    text-align:center;
    font-size:32px;
    color:#00ff99;
}

h2{
    margin-top:40px;
}

table{
    width:100%;
    border-collapse:collapse;
    margin:20px 0;
    background:#0b3d26;
}

th{
    background:#006633;
    padding:10px;
}

td{
    padding:8px;
    text-align:center;
    border-bottom:1px solid rgba(255,255,255,0.1);
}

tbody tr:nth-child(even){
    background:#0c462b;
}

.points{
    font-weight:bold;
    color:#00ff99;
}

select{
    padding:4px;
}

.fixture-box{
    max-height:250px;
    overflow-y:auto;
    background:#062d1c;
    padding:10px;
    border-radius:6px;
}

button{
    padding:6px 12px;
    border:none;
    border-radius:6px;
    font-weight:bold;
    cursor:pointer;
}

#loginBtn{ background:#00ff99; }
#logoutBtn{ background:#ff4d4d; display:none; }

.admin-badge{
    color:#00ff99;
    font-weight:bold;
}
</style>
</head>

<body>
<div class="overlay">

<h1>
ðŸŽ± LTM POOL TOURNAMENT 2026 ðŸŽ±
<span id="adminBadge" class="admin-badge"></span>
</h1>

<div style="text-align:center;margin-bottom:20px;">
<button id="loginBtn">Admin Login</button>
<button id="logoutBtn">Logout</button>
</div>

<div id="groups"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getDatabase, ref, set, update, onValue } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyD-3BzT-TYnkegIJOKmAd38yxrajr8jct8",
  authDomain: "ltm-pool-tournament.firebaseapp.com",
  databaseURL: "https://ltm-pool-tournament-default-rtdb.firebaseio.com",
  projectId: "ltm-pool-tournament",
  storageBucket: "ltm-pool-tournament.appspot.com",
  messagingSenderId: "1086941609764",
  appId: "1:1086941609764:web:051594093405f3ee83fdb1",
  measurementId: "G-PT3NL3RSG2"
};

    
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const auth = getAuth(app);

const provider = new GoogleAuthProvider();

const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const adminBadge = document.getElementById("adminBadge");

let isAdmin = false;

loginBtn.onclick = () => signInWithPopup(auth, provider);
logoutBtn.onclick = () => signOut(auth);

onAuthStateChanged(auth, user=>{
    if(user){
        isAdmin=true;
        adminBadge.innerText=" (ADMIN)";
        loginBtn.style.display="none";
        logoutBtn.style.display="inline-block";
    }else{
        isAdmin=false;
        adminBadge.innerText="";
        loginBtn.style.display="inline-block";
        logoutBtn.style.display="none";
    }
});

const groups={
"Group A":["Pratyush","Vamshi Krishna","Bhalchandra","Bhavik","Protim"],
"Group B":["Chirag","Karan","Tameem","Arif","Syam"],
"Group C":["Ganesh","Dinesh","Yash","Rachit","Ankit"],
"Group D":["Somyadeep","Shrey","Gaurav","Abdul","Vikas"]
};

const container=document.getElementById("groups");

function generateMatches(players){
let matches=[];
for(let i=0;i<players.length;i++){
for(let j=i+1;j<players.length;j++){
matches.push([players[i],players[j]]);
}
}
return matches;
}

for(let groupName in groups){

let players=groups[groupName];

let html=`<h2>${groupName}</h2>
<table>
<thead>
<tr>
<th>Player</th><th>P</th><th>W</th><th>L</th><th>Points</th>
</tr>
</thead><tbody>`;

players.forEach(p=>{
html+=`<tr data-player="${p}" data-group="${groupName}">
<td>${p}</td>
<td class="played">0</td>
<td class="wins">0</td>
<td class="loss">0</td>
<td class="points">0</td>
</tr>`;
});

html+=`</tbody></table>`;

let matches=generateMatches(players);

html+=`<div class="fixture-box"><table>
<tr><th>Match</th><th>Winner</th></tr>`;

matches.forEach(m=>{
let matchId=m[0]+"_vs_"+m[1];
html+=`
<tr>
<td>${m[0]} vs ${m[1]}</td>
<td>
<select data-group="${groupName}" data-match="${matchId}">
<option value="">Select</option>
<option value="${m[0]}">${m[0]}</option>
<option value="${m[1]}">${m[1]}</option>
</select>
</td>
</tr>`;
});

html+=`</table></div>`;

container.innerHTML+=html;
}

document.addEventListener("change",function(e){

if(!isAdmin) return;
if(!e.target.matches("select")) return;

let group=e.target.dataset.group;
let match=e.target.dataset.match;
let winner=e.target.value;

let [p1,p2]=match.split("_vs_");

update(ref(db,group+"/matches/"+match),{
winner:winner
});

});

for(let group in groups){

onValue(ref(db,group+"/matches"),snapshot=>{

let playersData={};

groups[group].forEach(p=>{
playersData[p]={wins:0,loss:0};
});

if(snapshot.exists()){
snapshot.forEach(matchSnap=>{
let match=matchSnap.key;
let data=matchSnap.val();
if(!data.winner) return;

let [p1,p2]=match.split("_vs_");

if(data.winner===p1){
playersData[p1].wins++;
playersData[p2].loss++;
}else if(data.winner===p2){
playersData[p2].wins++;
playersData[p1].loss++;
}
});
}

groups[group].forEach(p=>{
let row=document.querySelector(`tr[data-group="${group}"][data-player="${p}"]`);
let w=playersData[p].wins;
let l=playersData[p].loss;
row.querySelector(".wins").innerText=w;
row.querySelector(".loss").innerText=l;
row.querySelector(".played").innerText=w+l;
row.querySelector(".points").innerText=w*2;
});

});
}

</script>
</body>
</html>

